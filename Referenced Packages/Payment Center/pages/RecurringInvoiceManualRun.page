<apex:page standardController="fw1__Recurring_Invoice__c" extensions="fw1.RecurringInvoiceActionsController" showHeader="false" sidebar="false" action="{!onloadActions}">
    <apex:sectionHeader title="Process Recurring Invoice Manually" />

    <script>
        function closeAndRefreshParent() {
            parent.window.close();
            parent.window.opener.location.href = "/{!$Request.id}";   
        }
    </script>
    
    <apex:form >
        <apex:pageBlock >
            
            <apex:pageBlockSection columns="1">
                <!--<apex:outputText >The following will be carried out:</apex:outputText>-->
                <apex:outputText >- A new invoice will be created.</apex:outputText>
                <apex:outputText rendered="{!fw1__Recurring_Invoice__c.fw1__Auto_BillPay__c == false && fw1__Recurring_Invoice__c.fw1__Recipient_Email__c != null}">- The invoice will be emailed to {!fw1__Recurring_Invoice__c.fw1__Recipient_Email__c}.</apex:outputText>
                <apex:outputText rendered="{!fw1__Recurring_Invoice__c.fw1__Auto_BillPay__c == true && fw1__Recurring_Invoice__c.fw1__Recipient_Email__c != null}">- Collect payment for the invoice (Auto-BillPay) and send email receipt to {!fw1__Recurring_Invoice__c.fw1__Recipient_Email__c}.</apex:outputText>
            </apex:pageBlockSection>
            
            <apex:pageBlockButtons location="bottom">
                <apex:commandButton value="Cancel" onclick="top.window.close();" rendered="{!showCloseWindowButton == false}"/>
                <apex:commandButton value="Continue" action="{!manualRun}" rendered="{!showCloseWindowButton == false && showContinueButton = true}"/>
                <apex:commandButton value="Close Window" onclick="closeAndRefreshParent();" rendered="{!showCloseWindowButton == true}"/>
            </apex:pageBlockButtons>
            
            <apex:pageMessages />
            <br/>
            <br/>
        </apex:pageBlock>
    </apex:form>
</apex:page>