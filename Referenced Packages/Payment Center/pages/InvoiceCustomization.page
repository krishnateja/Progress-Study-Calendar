<apex:page standardController="fw1__Payment_Center_Setting__c" extensions="fw1.InvoiceCustomizationController" showHeader="false" sidebar="false">
    <apex:sectionHeader title="Customize Invoice" />
    
    <script>
        function closeAndRefreshParent() {
            parent.window.close();
            parent.window.opener.location.href = "/{!$Request.id}";    
        }
    </script>
    
    <apex:form >
        <apex:pageBlock >
        

            <apex:pageBlockSection columns="1" title="Customize Template" collapsible="false">
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle" rendered="{!docLogo != null}">
                    <apex:outputLabel value="Invoice Logo"/>
                    <apex:image id="docLogo" value="{!docLogo}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputPanel >
                        <apex:outputLabel value="Change Logo" rendered="{!docLogo != null}"/>
                        <apex:outputLabel value="Add Logo" rendered="{!docLogo == null}"/>
                    </apex:outputPanel>
                    <apex:panelGrid columns="1" >
                        <apex:inputfile value="{!logo.body}" filename="{!logo.Name}" />
                        <apex:commandbutton value="Upload" action="{!saveLogo}"/>
                    </apex:panelGrid>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
       </apex:pageBlock>
    </apex:form>
    <apex:form >
        <apex:pageBlock >
          <apex:pageBlockSection columns="1">
            <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                <apex:outputLabel value="Invoice Template"/>
                <apex:outputPanel >
                    <c:EmailTemplates value="{!emailTemplate}"/>&nbsp;&nbsp;&nbsp;
                    <!--<apex:outputLink value="{!emailTemplatesFolder}" target="_blank">See all templates</apex:outputLink>-->
                </apex:outputPanel>
            </apex:pageBlockSectionItem>
          <!--</apex:pageBlockSection>
             <apex:pageBlockSection >  -->  
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputLabel value="Default Terms And Conditions"/>
                    <apex:inputTextArea value="{!defaultTermsAndConditions}" rows="10" cols="80"/>
                </apex:pageBlockSectionItem>
                
            </apex:pageBlockSection>
                
            <apex:pageBlockSection columns="1" title="Email" collapsible="false">
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputLabel value="Default Email Subject"/>
                    <apex:inputText style="width:78%" value="{!defaultEmailSubject}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputLabel value="Default Email Message"/>
                    <apex:inputTextarea value="{!defaultEmailMessage}" rows="5" cols="80"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputLabel value="Additional Invoice Recipient"/>
                    <apex:inputText value="{!additionalInvoiceRecipient}"/>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="1" title="Advance" collapsible="false">
                <apex:pageBlockSectionItem labelStyle="vertical-align:middle">
                    <apex:outputlabel >
                        <c:EditTemplate template="{!emailTemplate}" label="Advance Edit"/>
                    </apex:outputlabel>
                    <apex:outputText >
                        For advanced customizations, the template can be manually edited using Visualforce. Follow the link on the left to edit the template.
                        <br/><br/>
                        More information on Visualforce Email Templates can be found here:&nbsp;<apex:outputLink value="{!VFTemplateHelp}" target="_blank">Email Template Help</apex:outputLink>
                    </apex:outputText>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            
            <apex:pageBlockButtons location="bottom">
                <!--<apex:outputPanel >
                    <apex:commandButton value="Close" onclick="parent.window.close();"/>
                    <apex:commandButton value="Save" action="{!Save}" />
                </apex:outputPanel>-->
               
      <apex:outputPanel id="buttons">
          <apex:commandButton value="Cancel" onclick="parent.window.close();"/>   
          <apex:commandButton action="{!Save}" value="Save" status="closer" reRender="buttons"/>
          <apex:actionStatus startText=" Saving..." stopText="" onStop="window.close();" id="closer"/>       
      </apex:outputPanel>
        
            </apex:pageBlockButtons>
    
        </apex:pageBlock>
    </apex:form>
</apex:page>